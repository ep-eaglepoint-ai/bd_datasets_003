// Prisma schema for Parcel Locker Access Portal
// Defines the database structure for lockers and parcels

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = "file:./dev.db"
}

// Locker model representing physical locker units
model Locker {
  id        Int      @id @default(autoincrement())
  size      String   // e.g., "small", "medium", "large"
  status    String   // AVAILABLE, OCCUPIED, EXPIRED
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  
  // Relationship: one locker can have multiple parcels over time
  parcels   Parcel[]
  
  @@index([status])
}

// Parcel model representing packages stored in lockers
model Parcel {
  id          Int      @id @default(autoincrement())
  recipient   String   // Email address of the recipient
  lockerId    Int      // Foreign key to Locker
  pinHash     String   // Hashed PIN (never store raw PIN)
  expiresAt   DateTime // Timestamp when PIN expires (48 hours from check-in)
  status      String   // OCCUPIED, COLLECTED, EXPIRED
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  
  // Relationship: parcel belongs to one locker
  locker      Locker   @relation(fields: [lockerId], references: [id])
  
  @@index([lockerId])
  @@index([status])
  @@index([expiresAt])
}
