services:
  test-before:
    build: .
    image: order-system-test
    volumes:
      - .:/workspace
    working_dir: /workspace
    command: echo "No tests to run for before state"

  test-after:
    image: order-system-test
    volumes:
      - .:/workspace
    working_dir: /workspace
    command: mvn -f repository_after/pom.xml test

  evaluation:
    image: order-system-test
    volumes:
      - .:/workspace
    working_dir: /workspace/evaluation
    # Install python3 in the container purely for the evaluation script
    command: /bin/sh -c "apk add --no-cache python3 && python3 evaluation.py"
