{
    "instance_id": "8N0IVU",
    "problem_statement": "Create a robust and production-ready spectral normalization framework in PyTorch that can be applied flexibly and safely across a wide range of neural network layers, including convolutional, transposed, and lazy modules, while handling numerical stability, initialization edge cases, and full model integration, and demonstrate its correctness through an included discriminator architecture.",
    "base_commit": "repository_before/",
    "test_patch": "tests/",
    "github_url": "https://github.com/ep-eaglepoint-ai/bd_datasets_003/tree/main/8n0ivu-advanced-spectral-normalization-system-for-pytorch-models",
    "environment_setup": "Dockerfile",
    "FAIL_TO_PASS": [
        "tests/test_spectral_norm.py::TestSpectralNormBasics::test_spectral_norm_exists",
        "tests/test_spectral_norm.py::TestSpectralNormBasics::test_remove_spectral_norm_exists",
        "tests/test_spectral_norm.py::TestSpectralNormBasics::test_apply_spectral_norm_exists",
        "tests/test_spectral_norm.py::TestSpectralNormBasics::test_discriminator_exists",
        "tests/test_spectral_norm.py::TestLinearLayer::test_linear_basic",
        "tests/test_spectral_norm.py::TestLinearLayer::test_linear_weight_normalized",
        "tests/test_spectral_norm.py::TestLinearLayer::test_linear_gradient_flows",
        "tests/test_spectral_norm.py::TestLinearLayer::test_linear_no_bias",
        "tests/test_spectral_norm.py::TestConvolutionalLayers::test_conv1d",
        "tests/test_spectral_norm.py::TestConvolutionalLayers::test_conv2d",
        "tests/test_spectral_norm.py::TestConvolutionalLayers::test_conv3d",
        "tests/test_spectral_norm.py::TestConvolutionalLayers::test_conv_gradient_flows",
        "tests/test_spectral_norm.py::TestConvTransposeLayers::test_conv_transpose1d",
        "tests/test_spectral_norm.py::TestConvTransposeLayers::test_conv_transpose2d",
        "tests/test_spectral_norm.py::TestConvTransposeLayers::test_conv_transpose3d",
        "tests/test_spectral_norm.py::TestConvTransposeLayers::test_conv_transpose_weight_reshape",
        "tests/test_spectral_norm.py::TestLazyModules::test_lazy_linear_deferred_init",
        "tests/test_spectral_norm.py::TestLazyModules::test_lazy_conv2d_deferred_init",
        "tests/test_spectral_norm.py::TestLazyModules::test_lazy_conv_transpose2d",
        "tests/test_spectral_norm.py::TestPowerIteration::test_configurable_iterations",
        "tests/test_spectral_norm.py::TestPowerIteration::test_power_iter_on_eval",
        "tests/test_spectral_norm.py::TestPowerIteration::test_no_power_iter_on_eval",
        "tests/test_spectral_norm.py::TestNumericalStability::test_eps_parameter",
        "tests/test_spectral_norm.py::TestNumericalStability::test_stable_fp32_default",
        "tests/test_spectral_norm.py::TestBufferManagement::test_buffers_registered",
        "tests/test_spectral_norm.py::TestBufferManagement::test_buffers_in_state_dict",
        "tests/test_spectral_norm.py::TestMultipleParameters::test_multiple_param_names",
        "tests/test_spectral_norm.py::TestMultipleParameters::test_skip_missing_param",
        "tests/test_spectral_norm.py::TestRecursiveApplication::test_apply_to_model",
        "tests/test_spectral_norm.py::TestRecursiveApplication::test_include_types_filter",
        "tests/test_spectral_norm.py::TestRecursiveApplication::test_exclude_types_filter",
        "tests/test_spectral_norm.py::TestRecursiveApplication::test_exclude_names_filter",
        "tests/test_spectral_norm.py::TestRecursiveApplication::test_predicate_filter",
        "tests/test_spectral_norm.py::TestRemoveSpectralNorm::test_remove_basic",
        "tests/test_spectral_norm.py::TestRemoveSpectralNorm::test_remove_restores_weight",
        "tests/test_spectral_norm.py::TestRemoveSpectralNorm::test_remove_recursive",
        "tests/test_spectral_norm.py::TestDiscriminator::test_discriminator_forward",
        "tests/test_spectral_norm.py::TestDiscriminator::test_discriminator_has_sn",
        "tests/test_spectral_norm.py::TestDiscriminator::test_discriminator_configurable_depth",
        "tests/test_spectral_norm.py::TestDiscriminator::test_discriminator_gradient_flow",
        "tests/test_spectral_norm.py::TestDiscriminator::test_discriminator_global_sum_pooling",
        "tests/test_spectral_norm.py::TestWeightOrigAndBuffer::test_original_weight_stored",
        "tests/test_spectral_norm.py::TestWeightOrigAndBuffer::test_normalized_weight_during_forward",
        "tests/test_spectral_norm.py::TestSelfContainedFile::test_single_file_import",
        "tests/test_spectral_norm.py::TestSelfContainedFile::test_only_pytorch_dependencies",
        "tests/test_spectral_norm.py::TestEdgeCases::test_empty_model",
        "tests/test_spectral_norm.py::TestEdgeCases::test_module_without_weight",
        "tests/test_spectral_norm.py::TestEdgeCases::test_very_small_weight",
        "tests/test_spectral_norm.py::TestEdgeCases::test_double_application"
    ],
    "PASS_TO_PASS": []
}
